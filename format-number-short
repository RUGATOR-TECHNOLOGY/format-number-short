<?php
/**
 * Plugin Name: Format Number Short Free Plugin
 * Plugin URI: https://rugator.com
 * Description: Plugin para formatear números reducir la unidad más pequeña. Eje: 1000 = 1K | 1000000 = 1M | 1000000000 = 1B [rugator_format_number_short]1000[/rugator_format_number_short].
 * Version: 1.0.0
 *
 * Requires at least: 4.0
 * Requires PHP: 5.6
 *
 * Author: RUGATOR
 * Author URI: https://rugator.com/
 * License: GPL v2 or later
 * License URI: https://www.gnu.org/licenses/gpl-2.0.html
 * Update URI: https://rugator.com/
 * Text Domain: format-number-short
 * Domain Path: /languages
 */

// Verifica si se accede directamente al archivo del plugin y redirige al usuario
if (!defined('ABSPATH')) {
    exit; // Sal del archivo si se accede directamente
}

// Eliminar el shortcode si ya está registrado
if (shortcode_exists('rugator_format_number_short')) {
    remove_shortcode('rugator_format_number_short');
}

// Función formatear números: Ejemplo 1000 = 1K
function format_number_shortcode($atts, $content = null) {
    // Eliminar espacios en blanco alrededor del contenido
    $content = trim($content);

    // Verificar si el contenido es un número válido
    if (is_numeric($content)) {
        // Formatear el número según su tamaño
        if ($content >= 1000 && $content < 1000000) {
            $format = number_format($content / 1000, 1) . 'K';
        } elseif ($content >= 1000000 && $content < 1000000000) {
            $format = number_format($content / 1000000, 1) . 'M';
        } elseif ($content >= 1000000000 && $content < 1000000000000) {
            $format = number_format($content / 1000000000, 1) . 'B';
        } else {
            $format = number_format($content);
        }

        return $format;
    }
    // Si el contenido no es un número válido, se devuelve sin cambios
    return $content;
}

add_shortcode('rugator_format_number_short', 'format_number_shortcode');
